<!doctype html><html lang="vi"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tra cứu Hóa chất - Cibao</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"><style>body{background:#f4f7fb;font-family:Inter,Arial,Helvetica,sans-serif}.app-card{background:white;border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(35,49,86,.06)}.suggestions-list{z-index:1050;max-height:250px;overflow-y:auto}</style></head><body><div id="userView"><div class="container py-5"><div class="row justify-content-center"><div class="col-lg-10"><div class="app-card"><div class="text-center mb-4 no-print"><h3><i class="bi bi-search-heart"></i> Hệ thống Tra cứu Hóa chất</h3><div class="text-muted">Công ty TNHH Cibao (Dữ liệu chỉ tra cứu)</div></div><div class="position-relative no-print"><div class="input-group" style="border-radius:999px;padding:10px 12px;border:1px solid #dee2e6"><input id="searchInput" type="text" class="form-control border-0" placeholder="Nhập tên hóa chất để tra cứu..." autocomplete="off"><button id="searchBtn" class="btn btn-primary" style="border-radius:999px"><i class="bi bi-search"></i> Tìm kiếm</button></div><div id="userSuggestions" class="list-group position-absolute w-100 suggestions-list"></div></div><div id="resultsArea" class="mt-4"><div class="text-center text-muted">Đang tải dữ liệu...</div></div></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script>
            document.addEventListener('DOMContentLoaded', async ()=>{
                let chemicalDatabase=[];
                const UI={searchInput:document.getElementById('searchInput'),searchBtn:document.getElementById('searchBtn'),resultsArea:document.getElementById('resultsArea'),userSuggestions:document.getElementById('userSuggestions')};
                try {
                    const response = await fetch('database.json');
                    chemicalDatabase = await response.json();
                } catch(e) {
                    UI.resultsArea.innerHTML = '<div class="alert alert-danger">Không thể tải cơ sở dữ liệu. Vui lòng thử lại sau.</div>';
                    return;
                }

                function normalize(s){return s?s.toString().toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,''):''}
                function renderSdsResults(list=chemicalDatabase){UI.resultsArea.innerHTML='';if(!list||list.length===0){UI.resultsArea.innerHTML='<div class="alert alert-info">Không tìm thấy hóa chất phù hợp.</div>';return}let html='<div class="row g-3">';list.forEach(c=>{html+='<div class="col-md-6"><div class="card h-100"><div class="card-body"><h5>'+c.name+'</h5><p class="card-text mb-1"><small class="text-muted">NSX: '+(c.manufacturer||'N/A')+'</small></p><p class="card-text"><small class="text-muted">Ứng dụng: '+(c.application||'N/A')+'</small></p><div class="mt-2">'+(c.sdsFileName?'<a href="./sds_files/'+c.sdsFileName+'" target="_blank" class="btn btn-success btn-sm"><i class="bi bi-file-earmark-pdf"></i> Xem File SDS</a>':'<span class="text-muted small">Không có file SDS</span>')+'</div></div></div></div>'});html+='</div>';UI.resultsArea.innerHTML=html}
                function handleSearch(){const query=normalize(UI.searchInput.value);const filteredList = chemicalDatabase.filter(c=>normalize(c.name).includes(query) || normalize(c.code||'').includes(query));renderSdsResults(filteredList);UI.userSuggestions.innerHTML=''}
                UI.searchInput.addEventListener('input',()=>{const query=normalize(UI.searchInput.value);if(!query){UI.userSuggestions.innerHTML='';renderSdsResults(); return;}const matches=chemicalDatabase.filter(c=>normalize(c.name).includes(query)||normalize(c.code||'').includes(query)).slice(0,5);UI.userSuggestions.innerHTML=matches.map(m=>'<button type="button" class="list-group-item list-group-item-action" data-name="'+m.name+'">'+m.name+(m.code?' ('+m.code+')':'')+'</button>').join('')});
                UI.userSuggestions.addEventListener('click',e=>{if(e.target.tagName==='BUTTON'){UI.searchInput.value=e.target.dataset.name;UI.userSuggestions.innerHTML='';handleSearch()}});
                document.addEventListener('click',e=>{if(!UI.searchInput.parentElement.contains(e.target))UI.userSuggestions.innerHTML=''});
                UI.searchBtn.addEventListener('click',handleSearch);UI.searchInput.addEventListener('keydown',e=>{if(e.key==='Enter')handleSearch()});renderSdsResults()});</script></body></html>